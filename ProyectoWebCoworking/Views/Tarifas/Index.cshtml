@model IEnumerable<ProyectoWebCoworking.Models.Tarifa>
@{
	ViewData["Title"] = "Gestionar Tarifas";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Gestión de Tarifas</h1>

<p>
	<a asp-action="Create" class="btn btn-primary">Crear Nueva Tarifa</a>
</p>

<table class="table table-striped">
	<thead>
		<tr>
			<th>
				@Html.DisplayNameFor(model => model.Nombre)
			</th>
			<th>
				@Html.DisplayNameFor(model => model.Precio)
			</th>
			<th>
				@Html.DisplayNameFor(model => model.TipoRecurso)
			</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		@foreach (var item in Model)
		{
			<tr>
				<td>
					@Html.DisplayFor(modelItem => item.Nombre)
				</td>
				<td>
					@item.Precio.ToString("C")
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.TipoRecurso)
				</td>
				<td>
					<a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-warning btn-sm">Editar</a>
					<a asp-action="Details" asp-route-id="@item.Id" class="btn btn-info btn-sm">Detalles</a>

					<button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#modalConfirmarBorrado" data-id-tarifa="@item.Id" data-nombre-tarifa="@item.Nombre">Eliminar</button>
				</td>
			</tr>
		}
	</tbody>
</table>

<div class="modal fade" id="modalConfirmarBorrado" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="modalLabel">Confirmar Eliminación</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cancelar"></button>
			</div>
			<div class="modal-body">
				<p>¿Estás seguro que deseas eliminar la tarifa: <strong id="nombreTarifaModal"></strong>?</p>
				<p class="text-danger">Esta acción no se puede deshacer.</p>
			</div>
			<div class="modal-footer">
				<form asp-action="Delete" method="post">
					<input type="hidden" name="id" id="idTarifaHidden" />

					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
					<button type="submit" class="btn btn-danger">Eliminar</button>
				</form>
			</div>
		</div>
	</div>
</div>

@section Scripts {
	<script>
		//Esperamos a que la web esté lista
		$(document).ready(function () {

			//Capturamos el evento "show.bs.modal"
			$('#modalConfirmarBorrado').on('show.bs.modal', function (event) {

				//"event.relatedTarget" es el botón eliminar
				var button = $(event.relatedTarget);

				//Extraemos la información de los atributos del botón
				var id = button.data('id-tarifa');
				var nombre = button.data('nombre-tarifa');

				var modal = $(this);

				//Actualizamos el texto del modal con el nombre y el id
				modal.find('.modal-body #nombreTarifaModal').text(nombre);
				modal.find('.modal-footer #idTarifaHidden').val(id);
			});
		});
	</script>
}
